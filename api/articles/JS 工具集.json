{"title":"JS工具集","uid":"70f3dc3b65ff84d1ff3522c18e25ad00","slug":"JS 工具集","date":"2019-08-08T05:47:41.000Z","updated":"2025-04-30T08:11:18.848Z","comments":true,"path":"api/articles/JS 工具集.json","keywords":null,"cover":null,"content":"<h1 id=\"CommUtils-js\"><a href=\"#CommUtils-js\" class=\"headerlink\" title=\"CommUtils.js\"></a>CommUtils.js</h1><p>js 工具集合: </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 工具类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">&quot;use strict&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"title class_\">CommUtils</span> = <span class=\"variable language_\">window</span>.<span class=\"property\">CommUtils</span> = &#123;</span><br><span class=\"line\">    <span class=\"comment\">//字符串动态替换 </span></span><br><span class=\"line\">    <span class=\"comment\">// CommUtils.formatStr(&quot;&#123;0&#125;不能为&#123;1&#125;&quot;, &quot;分数&quot;, &quot;0&quot; -&gt; &quot;分数不能为0&quot;</span></span><br><span class=\"line\">\tformatStr : <span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123; </span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> args = <span class=\"title class_\">Array</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">slice</span>.<span class=\"title function_\">apply</span>(<span class=\"variable language_\">arguments</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> that = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (args.<span class=\"property\">length</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (args.<span class=\"property\">length</span> == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> args[<span class=\"number\">0</span>];</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> template = args[<span class=\"number\">0</span>];</span><br><span class=\"line\">\t\t\targs.<span class=\"title function_\">splice</span>(<span class=\"number\">0</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> args[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;object&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t\t\t$.<span class=\"title function_\">each</span>(args[<span class=\"number\">0</span>], <span class=\"keyword\">function</span>(<span class=\"params\">key, value</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\ttemplate = template.<span class=\"title function_\">replace</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(<span class=\"string\">&quot;&#123;&quot;</span> + key + <span class=\"string\">&quot;&#125;&quot;</span>, <span class=\"string\">&quot;g&quot;</span>), that.<span class=\"title function_\">isEmpty</span>(value) ? <span class=\"string\">&#x27;&#x27;</span> : value);</span><br><span class=\"line\">\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t$.<span class=\"title function_\">each</span>(args, <span class=\"keyword\">function</span>(<span class=\"params\">key, value</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\ttemplate = template.<span class=\"title function_\">replace</span>(<span class=\"built_in\">eval</span>(<span class=\"string\">&quot;/(&#123;)&quot;</span> + key + <span class=\"string\">&quot;(&#125;)/g&quot;</span>), that.<span class=\"title function_\">isEmpty</span>(value) ? <span class=\"string\">&#x27;&#x27;</span> : value);</span><br><span class=\"line\">\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> template;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// layer tip 封装</span></span><br><span class=\"line\">\t<span class=\"comment\">// CommUtils.initTip(); // 先载入jq扩展</span></span><br><span class=\"line\">\t<span class=\"comment\">// $(&quot;#id&quot;).tip(&quot;提示信息&quot;, top, 12000)</span></span><br><span class=\"line\">\tinitTip : <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t\t$.fn.<span class=\"property\">tip</span> = <span class=\"keyword\">function</span>(<span class=\"params\">content, direct, time</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (direct == <span class=\"literal\">undefined</span>) direct = <span class=\"string\">&#x27;bottom&#x27;</span>;</span><br><span class=\"line\">\t\t\tdirect = [<span class=\"string\">&#x27;top&#x27;</span>, <span class=\"string\">&#x27;right&#x27;</span>, <span class=\"string\">&#x27;bottom&#x27;</span>, <span class=\"string\">&#x27;left&#x27;</span>].<span class=\"title function_\">indexOf</span>(direct) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> index = layer.<span class=\"title function_\">tips</span>(content, <span class=\"variable language_\">this</span>, &#123;</span><br><span class=\"line\">\t\t\t\ttips : [direct, <span class=\"string\">&#x27;#f5c564&#x27;</span>],</span><br><span class=\"line\">\t\t\t\ttime : time ? time : <span class=\"number\">2000</span>,</span><br><span class=\"line\">\t\t\t\tanim : <span class=\"number\">6</span>,</span><br><span class=\"line\">\t\t\t\ttipsMore : <span class=\"literal\">true</span></span><br><span class=\"line\">\t\t\t&#125;);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (direct == <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">\t\t\t\t$(<span class=\"string\">&#x27;.layui-layer-tips[times=&quot;&#x27;</span> + index + <span class=\"string\">&#x27;&quot;] .layui-layer-content&#x27;</span>).<span class=\"title function_\">css</span>(<span class=\"string\">&#x27;top&#x27;</span>, <span class=\"string\">&#x27;-8px&#x27;</span>);</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (direct == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">\t\t\t\t$(<span class=\"string\">&#x27;.layui-layer-tips[times=&quot;&#x27;</span> + index + <span class=\"string\">&#x27;&quot;] .layui-layer-content&#x27;</span>).<span class=\"title function_\">css</span>(<span class=\"string\">&#x27;left&#x27;</span>, <span class=\"string\">&#x27;-8px&#x27;</span>);</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (direct == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t\t$(<span class=\"string\">&#x27;.layui-layer-tips[times=&quot;&#x27;</span> + index + <span class=\"string\">&#x27;&quot;] .layui-layer-content&#x27;</span>).<span class=\"title function_\">css</span>(<span class=\"string\">&#x27;top&#x27;</span>, <span class=\"string\">&#x27;8px&#x27;</span>);</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (direct == <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">\t\t\t\t$(<span class=\"string\">&#x27;.layui-layer-tips[times=&quot;&#x27;</span> + index + <span class=\"string\">&#x27;&quot;] .layui-layer-content&#x27;</span>).<span class=\"title function_\">css</span>(<span class=\"string\">&#x27;left&#x27;</span>, <span class=\"string\">&#x27;8px&#x27;</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// layer 弹出层</span></span><br><span class=\"line\">    openFrame : <span class=\"keyword\">function</span>(<span class=\"params\">title, url, width, height</span>) &#123; <span class=\"comment\">//layer frame窗口</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">layerWindow</span> = layer.<span class=\"title function_\">open</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">            <span class=\"attr\">anim</span>: -<span class=\"number\">1</span>,</span><br><span class=\"line\">            <span class=\"attr\">resize</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            <span class=\"attr\">title</span>: title,</span><br><span class=\"line\">            <span class=\"attr\">shadeClose</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            <span class=\"attr\">maxmin</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            <span class=\"attr\">shade</span>: <span class=\"number\">0.6</span>,</span><br><span class=\"line\">            <span class=\"attr\">area</span>: [width || <span class=\"string\">&#x27;90%&#x27;</span>, height || <span class=\"string\">&#x27;90%&#x27;</span>],</span><br><span class=\"line\">            <span class=\"attr\">content</span>: url <span class=\"comment\">//iframe的url</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 对象判空并初始化</span></span><br><span class=\"line\">\tifEmpty : <span class=\"keyword\">function</span>(<span class=\"params\">obj, defaultValue</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">isEmpty</span>(obj) ? <span class=\"variable language_\">this</span>.<span class=\"title function_\">isEmpty</span>(defaultValue) ? <span class=\"string\">&#x27;&#x27;</span> : defaultValue : obj;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 对象判空</span></span><br><span class=\"line\">\tisEmpty : <span class=\"keyword\">function</span>(<span class=\"params\">arg</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (arg == <span class=\"literal\">undefined</span> || arg == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> arg == <span class=\"string\">&#x27;string&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> arg == <span class=\"string\">&#x27;&#x27;</span> ? <span class=\"literal\">true</span> : <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> arg == <span class=\"string\">&#x27;object&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (arg <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Array</span> &amp;&amp; arg.<span class=\"property\">length</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> arg == <span class=\"string\">&#x27;number&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> !!arg;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 对象不为空</span></span><br><span class=\"line\">\t<span class=\"attr\">isNotEmpty</span>: <span class=\"keyword\">function</span>(<span class=\"params\">arg</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> !<span class=\"variable language_\">this</span>.<span class=\"title function_\">isEmpty</span>(arg);</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 计算文件大小</span></span><br><span class=\"line\">\tgetFileSize : <span class=\"keyword\">function</span>(<span class=\"params\">size</span>)&#123; <span class=\"comment\">//根据大小计算文件大小</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> unit = [<span class=\"string\">&quot;B&quot;</span>, <span class=\"string\">&quot;KB&quot;</span>, <span class=\"string\">&quot;MB&quot;</span>, <span class=\"string\">&quot;GB&quot;</span>, <span class=\"string\">&quot;TB&quot;</span>];</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> result = size,i = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (; i &lt;= <span class=\"number\">4</span>; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (result &gt; <span class=\"number\">1024</span>) &#123;</span><br><span class=\"line\">\t\t\t\tresult = result / <span class=\"number\">1024</span>;</span><br><span class=\"line\">\t\t\t\tresult = result.<span class=\"title function_\">toFixed</span>(<span class=\"number\">2</span>);</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (i &gt; <span class=\"number\">4</span>) &#123; i= <span class=\"number\">4</span>;&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> result + unit[i];</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 格式化时间</span></span><br><span class=\"line\">\tformatDate : <span class=\"keyword\">function</span> (<span class=\"params\">date, fmt</span>) &#123; <span class=\"comment\">//author: meizz </span></span><br><span class=\"line\">\t    <span class=\"keyword\">var</span> o = &#123;</span><br><span class=\"line\">\t        <span class=\"string\">&quot;M+&quot;</span>: date.<span class=\"title function_\">getMonth</span>() + <span class=\"number\">1</span>, <span class=\"comment\">//月份 </span></span><br><span class=\"line\">\t        <span class=\"string\">&quot;d+&quot;</span>: date.<span class=\"title function_\">getDate</span>(), <span class=\"comment\">//日 </span></span><br><span class=\"line\">\t        <span class=\"string\">&quot;h+&quot;</span>: date.<span class=\"title function_\">getHours</span>(), <span class=\"comment\">//小时 </span></span><br><span class=\"line\">\t        <span class=\"string\">&quot;m+&quot;</span>: date.<span class=\"title function_\">getMinutes</span>(), <span class=\"comment\">//分 </span></span><br><span class=\"line\">\t        <span class=\"string\">&quot;s+&quot;</span>: date.<span class=\"title function_\">getSeconds</span>(), <span class=\"comment\">//秒 </span></span><br><span class=\"line\">\t        <span class=\"string\">&quot;q+&quot;</span>: <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>((date.<span class=\"title function_\">getMonth</span>() + <span class=\"number\">3</span>) / <span class=\"number\">3</span>), <span class=\"comment\">//季度 </span></span><br><span class=\"line\">\t        <span class=\"string\">&quot;S&quot;</span>: date.<span class=\"title function_\">getMilliseconds</span>() <span class=\"comment\">//毫秒 </span></span><br><span class=\"line\">\t    &#125;;</span><br><span class=\"line\">\t    <span class=\"keyword\">if</span> (<span class=\"regexp\">/(y+)/</span>.<span class=\"title function_\">test</span>(fmt)) fmt = fmt.<span class=\"title function_\">replace</span>(<span class=\"title class_\">RegExp</span>.<span class=\"property\">$1</span>, (date.<span class=\"title function_\">getFullYear</span>() + <span class=\"string\">&quot;&quot;</span>).<span class=\"title function_\">substr</span>(<span class=\"number\">4</span> - <span class=\"title class_\">RegExp</span>.<span class=\"property\">$1</span>.<span class=\"property\">length</span>));</span><br><span class=\"line\">\t    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> k <span class=\"keyword\">in</span> o)</span><br><span class=\"line\">\t    <span class=\"keyword\">if</span> (<span class=\"keyword\">new</span> <span class=\"title class_\">RegExp</span>(<span class=\"string\">&quot;(&quot;</span> + k + <span class=\"string\">&quot;)&quot;</span>).<span class=\"title function_\">test</span>(fmt)) fmt = fmt.<span class=\"title function_\">replace</span>(<span class=\"title class_\">RegExp</span>.<span class=\"property\">$1</span>, (<span class=\"title class_\">RegExp</span>.<span class=\"property\">$1</span>.<span class=\"property\">length</span> == <span class=\"number\">1</span>) ? (o[k]) : ((<span class=\"string\">&quot;00&quot;</span> + o[k]).<span class=\"title function_\">substr</span>((<span class=\"string\">&quot;&quot;</span> + o[k]).<span class=\"property\">length</span>)));</span><br><span class=\"line\">\t    <span class=\"keyword\">return</span> fmt;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// ajax 封装</span></span><br><span class=\"line\">\tajax : <span class=\"keyword\">function</span>(<span class=\"params\">url, param, success, method, <span class=\"keyword\">async</span></span>) &#123; <span class=\"comment\">//异步请求</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> _this = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">async</span> == <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">async</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t$.<span class=\"title function_\">ajax</span>(&#123;</span><br><span class=\"line\">\t\t\turl : url,</span><br><span class=\"line\">\t\t\tdata : param,</span><br><span class=\"line\">\t\t\ttype : method || <span class=\"string\">&quot;get&quot;</span>,</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">async</span> : <span class=\"keyword\">async</span>,</span><br><span class=\"line\">\t\t\tsuccess : <span class=\"keyword\">function</span>(<span class=\"params\">data</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (data.<span class=\"property\">status</span> == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tsuccess &amp;&amp; <span class=\"title function_\">success</span>(data.<span class=\"property\">data</span>);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> ;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (data.<span class=\"property\">message</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t_this.<span class=\"title function_\">tipBox</span>(data.<span class=\"property\">message</span>);</span><br><span class=\"line\">\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t\t_this.<span class=\"title function_\">tipBox</span>(i18n[<span class=\"string\">&#x27;systemErr&#x27;</span>]);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;,</span><br><span class=\"line\">\t\t\terror : <span class=\"keyword\">function</span>(<span class=\"params\">data</span>) &#123;</span><br><span class=\"line\">\t\t\t\t_this.<span class=\"title function_\">tipBox</span>(i18n[<span class=\"string\">&#x27;systemErr&#x27;</span>]);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;);</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 对象深拷贝</span></span><br><span class=\"line\">\tclone : <span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123; </span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (data == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> newData = <span class=\"literal\">null</span>, _this = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> data == <span class=\"string\">&#x27;object&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (data.<span class=\"property\">length</span> != <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">\t\t\t\tnewData = [];</span><br><span class=\"line\">\t\t\t\t$.<span class=\"title function_\">each</span>(data, <span class=\"keyword\">function</span>(<span class=\"params\">i, value</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tnewData.<span class=\"title function_\">push</span>(_this.<span class=\"title function_\">clone</span>(value));</span><br><span class=\"line\">\t\t\t\t&#125;);</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\tnewData = &#123;&#125;;</span><br><span class=\"line\">\t\t\t\t$.<span class=\"title function_\">each</span>(data, <span class=\"keyword\">function</span>(<span class=\"params\">key, value</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tnewData[key] = _this.<span class=\"title function_\">clone</span>(value);</span><br><span class=\"line\">\t\t\t\t&#125;);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tnewData = data;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> newData;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// map转list</span></span><br><span class=\"line\">\t<span class=\"attr\">mapTranList</span>: <span class=\"keyword\">function</span>(<span class=\"params\">mapTemp</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> listTemp = [];</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> mapTemp)&#123;</span><br><span class=\"line\">\t\t\tlistTemp.<span class=\"title function_\">push</span>(mapTemp[key]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> listTemp;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// jq 文件上传封装, verificationImageFileMap: 文件校验map, 重复文件不再上传</span></span><br><span class=\"line\">\t<span class=\"attr\">uploadFile</span>: <span class=\"keyword\">function</span>(<span class=\"params\">event, uploadFileUrl, verificationImageFileMap</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> response = &#123;</span><br><span class=\"line\">\t\t\t<span class=\"string\">&#x27;successFiles&#x27;</span> : [],</span><br><span class=\"line\">\t\t\t<span class=\"string\">&#x27;errorFiles&#x27;</span>: []</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> tempFileName = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; event.<span class=\"property\">target</span>.<span class=\"property\">files</span>.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> formData = <span class=\"keyword\">new</span> <span class=\"title class_\">FormData</span>();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> file = event.<span class=\"property\">target</span>.<span class=\"property\">files</span>[i];</span><br><span class=\"line\">\t\t\ttempFileName = file.<span class=\"property\">name</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> fileKey = tempFileName + file.<span class=\"property\">size</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"title function_\">isEmpty</span>(verificationImageFileMap) || <span class=\"variable language_\">this</span>.<span class=\"title function_\">isEmpty</span>(verificationImageFileMap[fileKey])) &#123;</span><br><span class=\"line\">\t\t\t\tformData.<span class=\"title function_\">append</span>(<span class=\"string\">&#x27;file&#x27;</span>, file);</span><br><span class=\"line\">\t\t\t\tformData.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;name&quot;</span>, tempFileName);</span><br><span class=\"line\">\t\t\t\t$.<span class=\"title function_\">ajax</span>(&#123;</span><br><span class=\"line\">\t\t\t\t\turl : uploadFileUrl,</span><br><span class=\"line\">\t\t\t\t\ttype : <span class=\"string\">&#x27;POST&#x27;</span>,</span><br><span class=\"line\">\t\t\t\t\tdata : formData,</span><br><span class=\"line\">\t\t\t\t\t<span class=\"comment\">// 告诉jQuery不要去处理发送的数据</span></span><br><span class=\"line\">\t\t\t\t\tprocessData : <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t\t\t\t\t<span class=\"comment\">// 告诉jQuery不要去设置Content-Type请求头</span></span><br><span class=\"line\">\t\t\t\t\tcontentType : <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t\t\t\t\t<span class=\"attr\">async</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t\t\t\t\t<span class=\"attr\">beforeSend</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">\t\t\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t\t\tsuccess : <span class=\"keyword\">function</span>(<span class=\"params\">responseStr</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t\tresponse.<span class=\"property\">successFiles</span>.<span class=\"title function_\">push</span>(responseStr);</span><br><span class=\"line\">\t\t\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t\t\terror : <span class=\"keyword\">function</span>(<span class=\"params\">responseStr</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;文件上传失败!&quot;</span> + responseStr);</span><br><span class=\"line\">\t\t\t\t\t\tresponse.<span class=\"property\">errorFiles</span>.<span class=\"title function_\">push</span>(&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"string\">&#x27;fileName&#x27;</span>: tempFileName</span><br><span class=\"line\">\t\t\t\t\t\t&#125;);</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\te.<span class=\"property\">target</span>.<span class=\"property\">value</span>=<span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> response;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/* layui 等待 */</span></span><br><span class=\"line\">    <span class=\"attr\">showLoad</span>: <span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> layer.<span class=\"title function_\">msg</span>(msg, &#123;</span><br><span class=\"line\">            <span class=\"attr\">icon</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">            <span class=\"attr\">shade</span>: [<span class=\"number\">0.5</span>, <span class=\"string\">&#x27;#f5f5f5&#x27;</span>],</span><br><span class=\"line\">            <span class=\"attr\">scrollbar</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            <span class=\"attr\">offset</span>: <span class=\"string\">&#x27;auto&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">time</span>: <span class=\"number\">100000</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">closeLoad</span>: <span class=\"keyword\">function</span> (<span class=\"params\">index</span>) &#123;</span><br><span class=\"line\">        layer.<span class=\"title function_\">close</span>(index);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">showSuccess</span>: <span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) &#123;</span><br><span class=\"line\">        layer.<span class=\"title function_\">msg</span>(msg, &#123;<span class=\"attr\">time</span>: <span class=\"number\">1500</span>, <span class=\"attr\">offset</span>: <span class=\"string\">&#x27;auto&#x27;</span>, <span class=\"attr\">icon</span>: <span class=\"number\">1</span>&#125;);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">showFail</span>: <span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) &#123;</span><br><span class=\"line\">        layer.<span class=\"title function_\">msg</span>(msg, &#123;<span class=\"attr\">time</span>: <span class=\"number\">1500</span>, <span class=\"attr\">offset</span>: <span class=\"string\">&#x27;auto&#x27;</span>, <span class=\"attr\">icon</span>: <span class=\"number\">2</span>&#125;);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    closeLayer : <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!!<span class=\"variable language_\">this</span>.<span class=\"property\">layerWindow</span>) &#123;</span><br><span class=\"line\">            layer.<span class=\"title function_\">close</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">layerWindow</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> index= <span class=\"variable language_\">window</span>.<span class=\"property\">parent</span>.<span class=\"property\">layer</span>.<span class=\"title function_\">getFrameIndex</span>(<span class=\"variable language_\">window</span>.<span class=\"property\">name</span>)</span><br><span class=\"line\">\t\t\t<span class=\"variable language_\">window</span>.<span class=\"property\">parent</span>.<span class=\"property\">layer</span>.<span class=\"title function_\">close</span>(index);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 页面间传递数据 parent.postMessage(data);</span></span><br><span class=\"line\">\tonMessage : <span class=\"keyword\">function</span>(<span class=\"params\">callback</span>) &#123; <span class=\"comment\">//监听发送到本窗口的消息</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">addEventListener</span>)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;message&#x27;</span>,<span class=\"keyword\">function</span>(<span class=\"params\">event</span>)&#123;</span><br><span class=\"line\">\t\t\t\tcallback &amp;&amp; <span class=\"title function_\">callback</span>(event);</span><br><span class=\"line\">\t\t\t&#125;, <span class=\"literal\">false</span>);</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(<span class=\"variable language_\">window</span>.<span class=\"property\">attachEvent</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"variable language_\">window</span>.<span class=\"title function_\">attachEvent</span>(<span class=\"string\">&quot;onmessage&quot;</span>, <span class=\"keyword\">function</span> (<span class=\"params\">event</span>) &#123;</span><br><span class=\"line\">\t\t\t\tcallback &amp;&amp; <span class=\"title function_\">callback</span>(event);</span><br><span class=\"line\">\t\t\t&#125;);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 字符串处理</span></span><br><span class=\"line\">\t<span class=\"attr\">filterString</span>: <span class=\"keyword\">function</span>(<span class=\"params\">content, type</span>) &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">var</span> _this = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">    \t<span class=\"comment\">// 过滤中文</span></span><br><span class=\"line\">    \t<span class=\"keyword\">if</span> (type === <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> content.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/[\\u4e00-\\u9fa5]/g</span>,<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (type === <span class=\"number\">2</span>) &#123; <span class=\"comment\">// 数字转中文</span></span><br><span class=\"line\">    \t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">isNaN</span>(<span class=\"title class_\">Number</span>(node.<span class=\"property\">points</span>))) &#123;</span><br><span class=\"line\">    \t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> _this.<span class=\"title function_\">numberToChinese</span>(content);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 数字转中文</span></span><br><span class=\"line\">    numberToChinese : <span class=\"keyword\">function</span>(<span class=\"params\">number</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">isNaN</span>(<span class=\"title class_\">Number</span>(number))) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(<span class=\"string\">&quot;this is not number!&quot;</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> number;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> chnNumChar = [<span class=\"string\">&quot;零&quot;</span>,<span class=\"string\">&quot;一&quot;</span>,<span class=\"string\">&quot;二&quot;</span>,<span class=\"string\">&quot;三&quot;</span>,<span class=\"string\">&quot;四&quot;</span>,<span class=\"string\">&quot;五&quot;</span>,<span class=\"string\">&quot;六&quot;</span>,<span class=\"string\">&quot;七&quot;</span>,<span class=\"string\">&quot;八&quot;</span>,<span class=\"string\">&quot;九&quot;</span>];</span><br><span class=\"line\">        <span class=\"keyword\">var</span> chnUnitChar = [<span class=\"string\">&quot;&quot;</span>,<span class=\"string\">&quot;十&quot;</span>,<span class=\"string\">&quot;百&quot;</span>,<span class=\"string\">&quot;千&quot;</span>,<span class=\"string\">&quot;万&quot;</span>,<span class=\"string\">&quot;亿&quot;</span>,<span class=\"string\">&quot;万亿&quot;</span>,<span class=\"string\">&quot;亿亿&quot;</span>];</span><br><span class=\"line\">        <span class=\"keyword\">var</span> strIns = <span class=\"string\">&#x27;&#x27;</span>, chnStr = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> unitPos = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> zero = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(number &gt; <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> v = number % <span class=\"number\">10</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(v === <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!zero)&#123;</span><br><span class=\"line\">                    zero = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    chnStr = chnNumChar[v] + chnStr;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                zero = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                strIns = chnNumChar[v];</span><br><span class=\"line\">                <span class=\"comment\">// 10-19不要前缀</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (unitPos === <span class=\"number\">1</span> &amp;&amp; v === <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    strIns = chnUnitChar[unitPos];</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    strIns += chnUnitChar[unitPos]</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                chnStr = strIns + chnStr;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            unitPos++;</span><br><span class=\"line\">            number = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(number / <span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> chnStr;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"comment\">// 修改编辑字符后光标移动至末尾</span></span><br><span class=\"line\">\tmoveCursorEnd : <span class=\"keyword\">function</span>(<span class=\"params\">obj</span>) &#123;</span><br><span class=\"line\">\t\tobj.<span class=\"title function_\">focus</span>(); <span class=\"comment\">//解决ff不获取焦点无法定位问题</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> range = <span class=\"variable language_\">window</span>.<span class=\"title function_\">getSelection</span>();<span class=\"comment\">//创建range</span></span><br><span class=\"line\">\t\trange.<span class=\"title function_\">selectAllChildren</span>(obj);<span class=\"comment\">//range 选择obj下所有子内容</span></span><br><span class=\"line\">\t\trange.<span class=\"title function_\">collapseToEnd</span>();<span class=\"comment\">//光标移至最后</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// web localStorage 存储工具类</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"title class_\">StorageOperation</span> = <span class=\"title class_\">CommUtils</span>.<span class=\"property\">StorageOp</span> = &#123;</span><br><span class=\"line\">\tget : <span class=\"keyword\">function</span> (<span class=\"params\">key</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">localStorage</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> prefix = <span class=\"variable language_\">this</span>.<span class=\"title function_\">getPrefix</span>();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> item = <span class=\"variable language_\">window</span>.<span class=\"property\">localStorage</span>.<span class=\"title function_\">getItem</span>(prefix + key);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (item == <span class=\"literal\">undefined</span> || item == <span class=\"literal\">undefined</span> || item.<span class=\"title function_\">trim</span>() == <span class=\"string\">&#x27;&#x27;</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\titem = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(item);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (item.<span class=\"property\">end</span> &lt; <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>().<span class=\"title function_\">getMilliseconds</span>()) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"variable language_\">window</span>.<span class=\"property\">localStorage</span>.<span class=\"title function_\">removeItem</span>(prefix + key);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> item.<span class=\"property\">data</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tset : <span class=\"keyword\">function</span>(<span class=\"params\">key, value, timeoutMills</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"title class_\">CommUtils</span>.<span class=\"title function_\">isEmpty</span>(timeoutMills)) &#123;</span><br><span class=\"line\">\t\t\ttimeoutMills = <span class=\"number\">604800000</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">localStorage</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> prefix = <span class=\"variable language_\">this</span>.<span class=\"title function_\">getPrefix</span>();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">var</span> data = &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">&#x27;end&#x27;</span> : <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>().<span class=\"title function_\">getMilliseconds</span>() + timeoutMills,</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">&#x27;data&#x27;</span> : value</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"variable language_\">window</span>.<span class=\"property\">localStorage</span>.<span class=\"title function_\">setItem</span>(prefix + key, <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(data));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\tgetPrefix : <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">&#x27;timeout_storage_&#x27;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","text":"CommUtils.jsjs 工具集合: 12345678910111213141516171819202122232425262728293031323334...","permalink":"/post/JS 工具集","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"JS","slug":"JS","count":1,"path":"api/categories/JS.json"}],"tags":[{"name":"JS","slug":"JS","count":1,"path":"api/tags/JS.json"},{"name":"工具","slug":"工具","count":1,"path":"api/tags/工具.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#CommUtils-js\"><span class=\"toc-text\">CommUtils.js</span></a></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Docker 容器的底层实现（转载资料）","uid":"01b31d33e59784cdd89994ca196501a5","slug":"Docker 容器的底层实现（转载资料）","date":"2019-08-12T03:32:47.000Z","updated":"2025-04-30T08:11:18.832Z","comments":true,"path":"api/articles/Docker 容器的底层实现（转载资料）.json","keywords":null,"cover":[],"text":"写的非常详细，可以直接去原文看： Docker(1)底层实现 以下存档防止丢失～～ Docker底层实现Docker并没有传统虚拟化的Hypervisor层,因...","permalink":"/post/Docker 容器的底层实现（转载资料）","photos":[],"count_time":{"symbolsCount":"7.4k","symbolsTime":"7 mins."},"categories":[{"name":"Docker","slug":"Docker","count":7,"path":"api/categories/Docker.json"}],"tags":[{"name":"docker","slug":"docker","count":5,"path":"api/tags/docker.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题(添加版本号)","uid":"473446b30e00b79edab02d113b4cd921","slug":"Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题","date":"2019-08-08T04:55:49.000Z","updated":"2025-04-30T08:11:18.865Z","comments":true,"path":"api/articles/Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题.json","keywords":null,"cover":null,"text":"后端spring boot 添加配置: 123456# 国际化i18n: locale: zh_TW# 静态资源版本build: version: 010-0....","permalink":"/post/Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"Thymeleaf","slug":"Thymeleaf","count":4,"path":"api/categories/Thymeleaf.json"}],"tags":[{"name":"Thymeleaf","slug":"Thymeleaf","count":5,"path":"api/tags/Thymeleaf.json"},{"name":"国际化","slug":"国际化","count":3,"path":"api/tags/国际化.json"},{"name":"web缓存","slug":"web缓存","count":1,"path":"api/tags/web缓存.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}