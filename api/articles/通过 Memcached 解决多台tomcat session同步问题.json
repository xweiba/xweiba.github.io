{"title":"通过 Memcached 解决多台tomcat session同步问题","uid":"5a722539163216f9e12fecfef2d10901","slug":"通过 Memcached 解决多台tomcat session同步问题","date":"2018-07-26T05:34:36.000Z","updated":"2025-04-30T08:11:18.902Z","comments":true,"path":"api/articles/通过 Memcached 解决多台tomcat session同步问题.json","keywords":null,"cover":null,"content":"<h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><ul>\n<li>Nginx 负载均衡已配置</li>\n<li>Tomcat 已开启多个容器</li>\n<li>Tomcat 8</li>\n<li>官方文档: <code>https://github.com/magro/memcached-session-manager/wiki/SetupAndConfiguration</code></li>\n<li>参考资料: <code>https://www.cnblogs.com/jsonhc/p/7344902.html</code></li>\n<li></li>\n</ul>\n<h2 id=\"下载所需jar包-每个tomcat版本对应的包不同\"><a href=\"#下载所需jar包-每个tomcat版本对应的包不同\" class=\"headerlink\" title=\"下载所需jar包, 每个tomcat版本对应的包不同\"></a>下载所需jar包, 每个tomcat版本对应的包不同</h2><ul>\n<li><code>wget http://repo1.maven.org/maven2/de/javakaffee/msm/memcached-session-manager/2.1.1/memcached-session-manager-2.1.1.jar</code></li>\n<li><code>wget http://repo1.maven.org/maven2/de/javakaffee/msm/memcached-session-manager-tc8/2.1.1/memcached-session-manager-tc8-2.1.1.jar</code></li>\n<li><code>wget http://repo1.maven.org/maven2/net/spy/spymemcached/2.11.1/spymemcached-2.11.1.jar</code></li>\n<li>如果仅仅只是用java来做序列化器只需上面这三个包就ok</li>\n<li>下面两个包,配置后一直报错,未测试通过 </li>\n<li><code>wget http://repo1.maven.org/maven2/de/javakaffee/msm/msm-javolution-serializer/1.8.3/msm-javolution-serializer-1.8.3.jar</code></li>\n<li><code>wget http://repo1.maven.org/maven2/de/javakaffee/msm/msm-javolution-serializer/2.1.1/msm-javolution-serializer-2.1.1.jar</code></li>\n<li>下载完成后放入tomcat&#x2F;lib目录中</li>\n</ul>\n<h2 id=\"修改两个tomcat配置文件\"><a href=\"#修改两个tomcat配置文件\" class=\"headerlink\" title=\"修改两个tomcat配置文件\"></a>修改两个tomcat配置文件</h2><ul>\n<li><p>vim <code>&#123;tomcat&#125;/conf/context.xml</code></p>\n  <figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Context&gt;</span><br><span class=\"line\">    &lt;!-- web application will be reloaded.                                   --&gt;</span><br><span class=\"line\">    &lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;</span><br><span class=\"line\">    &lt;WatchedResource&gt;<span class=\"variable\">$&#123;catalina.base&#125;</span>/conf/web.xml&lt;/WatchedResource&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- Uncomment this to <span class=\"built_in\">disable</span> session persistence across Tomcat restarts --&gt;</span><br><span class=\"line\">    &lt;!--</span><br><span class=\"line\">    &lt;Manager pathname=<span class=\"string\">&quot;&quot;</span> /&gt;</span><br><span class=\"line\">    --&gt;</span><br><span class=\"line\">    &lt;Manager className=<span class=\"string\">&quot;de.javakaffee.web.msm.MemcachedBackupSessionManager&quot;</span></span><br><span class=\"line\">    memcachedNodes=<span class=\"string\">&quot;n1:127.0.0.1:11211,n2:127.0.0.1:22122&quot;</span></span><br><span class=\"line\">    failoverNodes=<span class=\"string\">&quot;n1&quot;</span></span><br><span class=\"line\">    requestUriIgnorePattern=<span class=\"string\">&quot;.*\\.(ico|png|gif|jpg|css|js)$&quot;</span></span><br><span class=\"line\">    /&gt;</span><br><span class=\"line\">&lt;/Context&gt;</span><br></pre></td></tr></table></figure></li>\n</ul>\n","text":"准备工作 Nginx 负载均衡已配置 Tomcat 已开启多个容器 Tomcat 8 官方文档: https://github.com/magro/memcac...","permalink":"/post/通过 Memcached 解决多台tomcat session同步问题","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"Memcached","slug":"Memcached","count":2,"path":"api/categories/Memcached.json"}],"tags":[{"name":"session","slug":"session","count":1,"path":"api/tags/session.json"},{"name":"tomcat","slug":"tomcat","count":1,"path":"api/tags/tomcat.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\"><span class=\"toc-text\">准备工作</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD%E6%89%80%E9%9C%80jar%E5%8C%85-%E6%AF%8F%E4%B8%AAtomcat%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E7%9A%84%E5%8C%85%E4%B8%8D%E5%90%8C\"><span class=\"toc-text\">下载所需jar包, 每个tomcat版本对应的包不同</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BF%AE%E6%94%B9%E4%B8%A4%E4%B8%AAtomcat%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">修改两个tomcat配置文件</span></a></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Sping @RestController 返回Json格式数据时不序列化null属性","uid":"7625e53cbd55975ec0a2b49c3c2bb1f3","slug":"Sping @RestController 返回Json格式数据时不序列化null属性","date":"2018-07-26T09:39:57.000Z","updated":"2025-04-30T08:11:18.862Z","comments":true,"path":"api/articles/Sping @RestController 返回Json格式数据时不序列化null属性.json","keywords":null,"cover":null,"text":"直接看代码1234567891011121314151617181920212223242526272829303132333435363738394041/*...","permalink":"/post/Sping @RestController 返回Json格式数据时不序列化null属性","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"Spring","slug":"Spring","count":7,"path":"api/categories/Spring.json"}],"tags":[{"name":"Spring","slug":"Spring","count":8,"path":"api/tags/Spring.json"},{"name":"Json序列化","slug":"Json序列化","count":1,"path":"api/tags/Json序列化.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Java 服务中文乱码","uid":"6aa8ceb80f4b9b7def699e1275eccff9","slug":"Java 服务中文乱码","date":"2018-07-26T04:58:33.000Z","updated":"2025-04-30T08:11:18.851Z","comments":true,"path":"api/articles/Java 服务中文乱码.json","keywords":null,"cover":null,"text":" 最近发现运维大哥在新环境部署相关服务后生成的数据出现中文乱码的问题, 记录一下 修改系统编码环境变量locale 查看当前系统编码: 这是修改后正常状态, 如...","permalink":"/post/Java 服务中文乱码","photos":[],"count_time":{"symbolsCount":563,"symbolsTime":"1 mins."},"categories":[{"name":"Java","slug":"Java","count":5,"path":"api/categories/Java.json"}],"tags":[{"name":"Java","slug":"Java","count":11,"path":"api/tags/Java.json"},{"name":"乱码","slug":"乱码","count":1,"path":"api/tags/乱码.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}