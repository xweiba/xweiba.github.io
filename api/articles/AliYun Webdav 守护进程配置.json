{"title":"AliYun Webdav 守护进程配置","uid":"6b3e720923b0ba26fd3bbe6579affa3f","slug":"AliYun Webdav 守护进程配置","date":"2022-12-23T06:44:10.000Z","updated":"2025-04-30T08:11:18.830Z","comments":true,"path":"api/articles/AliYun Webdav 守护进程配置.json","keywords":null,"cover":null,"content":"<ol>\n<li>wget 下载 webdav-aliyundriver jar 包，获取 yourefreshtoken 文档也在说明页，其他参数可以自己加载脚本后面</li>\n<li>安装 jre 环境 apt install default-jre</li>\n<li>创建启动和停止脚本，文件目录用自己的</li>\n</ol>\n<p>vi stop.sh</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;webdav-aliyundriver will be stoped.....&quot;</span></span><br><span class=\"line\">pid=$(ps aux|grep -v grep|grep webdav-aliyundriver*.jar|awk <span class=\"string\">&#x27;&#123;print $2&#125;&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> [[ <span class=\"variable\">$pid</span> -gt 1 ]]; <span class=\"keyword\">then</span></span><br><span class=\"line\">    <span class=\"built_in\">kill</span> -9 <span class=\"variable\">$pid</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<p>vi start.sh</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">/mnt/nas/data/dev_tools/webdav/aliyun/stop.sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;webdav-aliyundriver will be start.....&quot;</span></span><br><span class=\"line\">java -jar /mnt/nas/data/dev_tools/webdav/aliyun/webdav-aliyundriver-2.4.2.jar --aliyundrive.refresh-token=<span class=\"string\">&quot;yourefreshtoken&quot;</span> &gt; /dev/null &amp;</span><br></pre></td></tr></table></figure>\n\n<p>加权限 chmod +x start.sh stop.sh</p>\n<ol start=\"4\">\n<li>创建守护线程服务<br>vi &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;webdav-ali.service<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=Webdav Aliyun</span><br><span class=\"line\"># 在什么服务启动之后再执行本程序</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Type=forking</span><br><span class=\"line\"># 程序执行的目录</span><br><span class=\"line\">WorkingDirectory=/mnt/nas/data/dev_tools/webdav/aliyun/</span><br><span class=\"line\"># 启动的脚本命令</span><br><span class=\"line\">ExecStart=/mnt/nas/data/dev_tools/webdav/aliyun/start.sh</span><br><span class=\"line\">ExecReload=/mnt/nas/data/dev_tools/webdav/aliyun/start.sh</span><br><span class=\"line\">ExecStop=/mnt/nas/data/dev_tools/webdav/aliyun/stop.sh</span><br><span class=\"line\"># 重启条件</span><br><span class=\"line\">Restart=always</span><br><span class=\"line\"># 几秒后重启</span><br><span class=\"line\">RestartSec=5</span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>开启服务</p>\n<ol>\n<li>重载 systemctl daemon-reload</li>\n<li>开机自启 systemctl enable webdav-ali</li>\n<li>启动 systemctl start webdav-ali</li>\n<li>查看状态 systemctl start webdav-ali</li>\n</ol>\n","text":" wget 下载 webdav-aliyundriver jar 包，获取 yourefreshtoken 文档也在说明页，其他参数可以自己加载脚本后面 安装 ...","permalink":"/post/AliYun Webdav 守护进程配置","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"Webdav","slug":"Webdav","count":1,"path":"api/categories/Webdav.json"}],"tags":[{"name":"Webdav","slug":"Webdav","count":1,"path":"api/tags/Webdav.json"},{"name":"Aliyun","slug":"Aliyun","count":1,"path":"api/tags/Aliyun.json"}],"toc":"","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"docker transmission 制作种子","uid":"dc1c644c622f4be60aa728bcd1bd8760","slug":"docker transmission 制作种子","date":"2022-12-23T06:45:19.000Z","updated":"2025-04-30T08:11:18.900Z","comments":true,"path":"api/articles/docker transmission 制作种子.json","keywords":null,"cover":null,"text":"docker transmission 制作种子123docker exec -it tran bashcd /user/bintransmission-cre...","permalink":"/post/docker transmission 制作种子","photos":[],"count_time":{"symbolsCount":262,"symbolsTime":"1 mins."},"categories":[{"name":"docker","slug":"docker","count":2,"path":"api/categories/docker.json"}],"tags":[{"name":"transmission","slug":"transmission","count":1,"path":"api/tags/transmission.json"},{"name":"制作种子","slug":"制作种子","count":1,"path":"api/tags/制作种子.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"DDNS和证书配置","uid":"cbe323e32f8b37c93337862c65bef9d6","slug":"DDNS和证书配置","date":"2022-12-23T06:42:26.000Z","updated":"2025-04-30T08:11:18.832Z","comments":true,"path":"api/articles/DDNS和证书配置.json","keywords":null,"cover":null,"text":"DDNS 项目地址：https://github.com/rehiy/dnspod-shell 一、编辑配置文件vim ddnspod.sh 123456789...","permalink":"/post/DDNS和证书配置","photos":[],"count_time":{"symbolsCount":859,"symbolsTime":"1 mins."},"categories":[{"name":"DDNS","slug":"DDNS","count":1,"path":"api/categories/DDNS.json"}],"tags":[{"name":"DDNS","slug":"DDNS","count":1,"path":"api/tags/DDNS.json"},{"name":"HTTPS","slug":"HTTPS","count":1,"path":"api/tags/HTTPS.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}