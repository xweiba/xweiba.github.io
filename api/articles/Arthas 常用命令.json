{"title":"Arthas 常用命令","uid":"e76e3ec505bc6c5905c40e8de4c802ac","slug":"Arthas 常用命令","date":"2022-12-23T04:17:53.000Z","updated":"2025-04-30T08:11:18.831Z","comments":true,"path":"api/articles/Arthas 常用命令.json","keywords":null,"cover":[],"content":"<h1 id=\"Arthas-常用命令\"><a href=\"#Arthas-常用命令\" class=\"headerlink\" title=\"Arthas 常用命令\"></a>Arthas 常用命令</h1><p>官方文档：<a href=\"https://alibaba.github.io/arthas/commands.html\">Arthas 命令列表</a></p>\n<h2 id=\"启动-Arthas\"><a href=\"#启动-Arthas\" class=\"headerlink\" title=\"启动 Arthas\"></a>启动 Arthas</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://alibaba.github.io/arthas/arthas-demo.jar</span><br><span class=\"line\">java -jar arthas-demo.jar</span><br><span class=\"line\"></span><br><span class=\"line\">curl -O https://alibaba.github.io/arthas/arthas-boot.jar</span><br><span class=\"line\">java -jar arthas-boot.jar</span><br></pre></td></tr></table></figure>\n<p>注意退出的时候要 <code>stop</code>, 用 <code>quit</code> 不会退出.</p>\n<h2 id=\"开启日志\"><a href=\"#开启日志\" class=\"headerlink\" title=\"开启日志\"></a>开启日志</h2><p>默认情况下，该功能是关闭的，如果需要开启，请执行以下命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ options save-result true</span><br><span class=\"line\"> NAME         BEFORE-VALUE  AFTER-VALUE</span><br><span class=\"line\">----------------------------------------</span><br><span class=\"line\">save-result  false         true</span><br><span class=\"line\">Affect(row-cnt:1) cost in 3 ms.</span><br></pre></td></tr></table></figure>\n<p>看到上面的输出，即表示成功开启该功能；</p>\n<p>日志文件路径: 结果会异步保存在：{user.home}&#x2F;logs&#x2F;arthas-cache&#x2F;result.log，请定期进行清理，以免占据磁盘空间</p>\n<p>输出指定数据: <code>watch com.enableets.edu.assessment.framework.reportV2.factory.AbstractReportFactory dataSliceQuery &#39;&#123;params,returnObj&#125;&#39; -x 6 &gt; dataSliceQuery.txt</code></p>\n<p>文件会存储至 <code>jar</code> 包目录</p>\n<h2 id=\"watch\"><a href=\"#watch\" class=\"headerlink\" title=\"watch\"></a>watch</h2><img src=\"/post/Arthas%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/SBPvmZ6NukwCETe.png\" class=\"\" title=\"img\">\n<p>watch 依次参数：接口地址 方法名称 ognl表达式 观察模式(可不需要)</p>\n<ul>\n<li><p>打印方法第一个入参：</p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">watch com.test.xxx query &#x27;params[0]&#x27;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>打印入参和返回值</p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">watch com.xxx.Service xxxFunction &#x27;&#123;params,returnObj&#125;&#x27; -x 6</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>如果入参是对象，打印的是对象地址，可通过参数名<code>params[0].name</code>或调用JSON转换成字符串，也可以使用<code>-x 3(遍历属性深度层次数)</code></p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">watch com.test.xxx query &#x27;@com.alibaba.fastjson.JSON@toJSON(&#123;params[0]&#125;)[0]&#x27;</span><br></pre></td></tr></table></figure>\n  <img src=\"/post/Arthas%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/cd1xELTvPwK89BO.png\" class=\"\" title=\"img\">\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">watch com.test.xxx query &#x27;&#123;params[0]&#125;&#x27; -b -x 3</span><br></pre></td></tr></table></figure>\n  <img src=\"/post/Arthas%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/BWNucritTZXlLRp.png\" class=\"\" title=\"img\"></li>\n</ul>\n<h2 id=\"SC\"><a href=\"#SC\" class=\"headerlink\" title=\"SC\"></a>SC</h2><ul>\n<li>查找 <code>classLoaderHash</code>   <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 随便找一个实例即可获取 classLoaderHash</span><br><span class=\"line\">sc -d com.test.xxx.util.BeanUtils | grep classLoaderHash</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"ognl\"><a href=\"#ognl\" class=\"headerlink\" title=\"ognl\"></a>ognl</h2><p>可通过 <code>ognl</code> 表达式执行某个静态方法</p>\n<ul>\n<li>修改某个对象的 <code>debug</code> 级别  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ognl -c 5b2133b1 &#x27;@com.test.xxx.service.CommCacheDataService@LOGGER.setLevel(@ch.qos.logback.classic.Level@INFO)&#x27;</span><br></pre></td></tr></table></figure></li>\n<li>修改全局的 <code>debug</code> 级别  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ognl -c 5b2133b1 &#x27;@org.slf4j.LoggerFactory@getLogger(&quot;root&quot;).setLevel(@ch.qos.logback.classic.Level@INFO)&#x27;</span><br></pre></td></tr></table></figure></li>\n</ul>\n","text":"Arthas 常用命令官方文档：Arthas 命令列表 启动 Arthas12345wget https://alibaba.github.io/arthas/...","permalink":"/post/Arthas 常用命令","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"Arthas","slug":"Arthas","count":2,"path":"api/categories/Arthas.json"}],"tags":[{"name":"常用命令","slug":"常用命令","count":10,"path":"api/tags/常用命令.json"},{"name":"Arthas","slug":"Arthas","count":2,"path":"api/tags/Arthas.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Arthas-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">Arthas 常用命令</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8-Arthas\"><span class=\"toc-text\">启动 Arthas</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%90%AF%E6%97%A5%E5%BF%97\"><span class=\"toc-text\">开启日志</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#watch\"><span class=\"toc-text\">watch</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SC\"><span class=\"toc-text\">SC</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ognl\"><span class=\"toc-text\">ognl</span></a></li></ol></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"ES 随机查询","uid":"2d77fc843e6a4b44f155d2170280baf0","slug":"ES 随机查询","date":"2022-12-23T04:50:04.000Z","updated":"2025-04-30T08:11:18.833Z","comments":true,"path":"api/articles/ES 随机查询.json","keywords":null,"cover":null,"text":"根据官方文档使用随机评分查询, 随机因子设置为当前时间, 即可实现指定条件的随机数据查询. 参考文档: ELK第七篇:spring-boot-starter-d...","permalink":"/post/ES 随机查询","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"ES","slug":"ES","count":1,"path":"api/categories/ES.json"}],"tags":[{"name":"ES","slug":"ES","count":1,"path":"api/tags/ES.json"},{"name":"随机查询","slug":"随机查询","count":1,"path":"api/tags/随机查询.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Android 环境安装","uid":"444a9230e1bb32e21e783ab2e50b70d6","slug":"Android 环境安装","date":"2022-12-23T03:41:02.000Z","updated":"2025-04-30T08:11:18.830Z","comments":true,"path":"api/articles/Android 环境安装.json","keywords":null,"cover":null,"text":"Android SDK 安装新建SDK文件夹并加入环境变量 SDK主目录：C:\\Users\\wb\\Documents\\Android\\Android-SDK 命...","permalink":"/post/Android 环境安装","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"Android","slug":"Android","count":3,"path":"api/categories/Android.json"}],"tags":[{"name":"Android","slug":"Android","count":3,"path":"api/tags/Android.json"},{"name":"环境","slug":"环境","count":4,"path":"api/tags/环境.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}