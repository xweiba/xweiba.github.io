{"title":"Shell-抽取Jar包中的静态文件","uid":"f320592293c9a5b6cd2058e0782dac6f","slug":"Shell-抽取Jar包中的静态文件","date":"2019-11-06T07:56:14.000Z","updated":"2025-04-30T08:11:18.862Z","comments":true,"path":"api/articles/Shell-抽取Jar包中的静态文件.json","keywords":null,"cover":null,"content":"<h1 id=\"抽取Jar包中的静态文件\"><a href=\"#抽取Jar包中的静态文件\" class=\"headerlink\" title=\"抽取Jar包中的静态文件\"></a>抽取<code>Jar</code>包中的静态文件</h1><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">!/bin/bash</span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"><span class=\"comment\">######################</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">created by code on 2019/11/06 15:56:14</span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"><span class=\"comment\">######################</span></span></span><br><span class=\"line\">function setVars()&#123;</span><br><span class=\"line\">       basepath=/home/icampus3.0</span><br><span class=\"line\">       jdkHome=$&#123;basepath&#125;/jdk8</span><br><span class=\"line\">       servHome=$&#123;basepath&#125;/pkgs/paper-manager</span><br><span class=\"line\"></span><br><span class=\"line\">       start=$&#123;servHome&#125;/start.sh</span><br><span class=\"line\">       log=$&#123;basepath&#125;/logs/paper-manager.log</span><br><span class=\"line\">       java=$&#123;jdkHome&#125;/bin/java</span><br><span class=\"line\">       servFile=$&#123;servHome&#125;/paper-manager.jar</span><br><span class=\"line\">       option=&quot;-server -Xms180m -Xmx200m -Dfile.encoding=utf-8 -Dspring.config.location=bootstrap.yml -Darchaius.configurationSource.additionalUrls=file:///home/icampus3.0/pkgs/config/conf_prod/globalconfig.properties -jar $&#123;servFile&#125; &quot;</span><br><span class=\"line\"></span><br><span class=\"line\">       # manager unzip config</span><br><span class=\"line\">       servName=paper</span><br><span class=\"line\">       jarPath=BOOT-INF/classes</span><br><span class=\"line\">       # 静态文件配置</span><br><span class=\"line\">       servJsPath=$&#123;jarPath&#125;/static/custom/$&#123;servName&#125;</span><br><span class=\"line\">       JsHome=$&#123;basepath&#125;/icampus-static/custom/$&#123;servName&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       # templates 文件配置</span><br><span class=\"line\">       servHtmlPath=$&#123;jarPath&#125;/templates</span><br><span class=\"line\">       HtmlHome=$&#123;servHome&#125;/templates</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">function start()&#123;</span><br><span class=\"line\">       cd $servHome</span><br><span class=\"line\">       sh stop.sh</span><br><span class=\"line\">       echo -e &quot;  Start to start up paper-manager : &quot;</span><br><span class=\"line\"></span><br><span class=\"line\">       $java $option &gt; $log 2&gt;&amp;1 &amp;</span><br><span class=\"line\"></span><br><span class=\"line\">       echo $! &gt; pid</span><br><span class=\"line\"></span><br><span class=\"line\">       if [[ -z $(cat pid) ]]; then</span><br><span class=\"line\">           echo -e &quot;  Failed to start up paper-manager&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">           return 1</span><br><span class=\"line\">       else</span><br><span class=\"line\">           echo -e &quot;  Successful to start up paper-manager&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">           return 0</span><br><span class=\"line\">       fi</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"variable\">$1</span>:处理类型 <span class=\"variable\">$2</span>:jar包中的相对路径 <span class=\"variable\">$3</span>:部署的绝对路径, 会自动在部署路径添加_bak后缀生成上一次的备份文件夹</span></span><br><span class=\"line\">function unzipStaticFile() &#123;</span><br><span class=\"line\">      echo -e &quot;  &quot;</span><br><span class=\"line\">      echo -e &quot;  ---------UnzipStaticFile start---------&quot;</span><br><span class=\"line\">      cd $servHome</span><br><span class=\"line\">      if [ ! -n &quot;$1&quot; -o ! -n &quot;$2&quot; -o ! -n &quot;$3&quot; ]</span><br><span class=\"line\">         then</span><br><span class=\"line\">           echo -e &quot;  Unzip params is Not Full!&quot;</span><br><span class=\"line\">           echo -e &quot;  Params: typeName:$1, unzipTempPath:$2, dstPath:$3&quot;</span><br><span class=\"line\">           exit 1</span><br><span class=\"line\">      fi</span><br><span class=\"line\">      echo -e &quot;  Start unZip paper-manager $1 file...&quot;</span><br><span class=\"line\">      echo -e &quot;  Params: typeName:$1, unzipTempPath:$2, dstPath:$3&quot;</span><br><span class=\"line\">      echo &quot;  Clean unzip temp path: $&#123;servHome&#125;/temp/$2&quot;</span><br><span class=\"line\">      rm -rf $&#123;servHome&#125;/temp/$2  &gt;/dev/null 2&gt;&amp;1</span><br><span class=\"line\">      echo &quot;  Unzip ...&quot;</span><br><span class=\"line\">      unzip $&#123;servFile&#125; $2/* -d $&#123;servHome&#125;/temp &gt;/dev/null 2&gt;&amp;1</span><br><span class=\"line\">      # wait 1s unzip Successful</span><br><span class=\"line\">      sleep 1</span><br><span class=\"line\">      if [ $? -ne 0 ]</span><br><span class=\"line\">        then</span><br><span class=\"line\">            echo -e &quot;  paper-manager unzip Failed!&quot;</span><br><span class=\"line\">            exit 1</span><br><span class=\"line\">      fi</span><br><span class=\"line\">      echo -e &quot;  Unzip Successful!\\n&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">      echo -e &quot;  Start Deploy paper-manager $1 file...&quot;</span><br><span class=\"line\">      # 判断备份文件夹是否存在</span><br><span class=\"line\">      if [ -d &quot;$3_bak&quot; ]</span><br><span class=\"line\">        then</span><br><span class=\"line\">        echo &quot;  Clean paper-manager $1 file old backup path: $3_bak&quot;</span><br><span class=\"line\">        rm -rf &quot;$3_bak&quot; &gt;/dev/null 2&gt;&amp;1</span><br><span class=\"line\">      fi</span><br><span class=\"line\"></span><br><span class=\"line\">      # 备份一份</span><br><span class=\"line\">      echo &quot;  Backup now paper-manager $1 file path: $3_bak&quot;</span><br><span class=\"line\">      mv $3 &quot;$3_bak&quot; &gt;/dev/null 2&gt;&amp;1</span><br><span class=\"line\">      # 将新的静态文件移动过来</span><br><span class=\"line\">      echo &quot;  Move new paper-manager $1 file path:$3&quot;</span><br><span class=\"line\">      mv $&#123;servHome&#125;/temp/$2 $3 &gt;/dev/null 2&gt;&amp;1</span><br><span class=\"line\">      echo -e &quot;  Deploy paper-manager $1 file Successful!&quot;</span><br><span class=\"line\">      echo -e &quot;  ---------UnzipStaticFile end---------&quot;</span><br><span class=\"line\">      echo -e &quot;  &quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">setVars</span><br><span class=\"line\">start</span><br><span class=\"line\">unzipStaticFile JS $&#123;servJsPath&#125; $&#123;JsHome&#125;</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">html 可选部署</span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$1</span> -a <span class=\"variable\">$1</span> = 1 ]</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"keyword\">then</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">unzipStaticFile Html <span class=\"variable\">$&#123;servHtmlPath&#125;</span> <span class=\"variable\">$&#123;HtmlHome&#125;</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"><span class=\"keyword\">fi</span></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","text":"抽取Jar包中的静态文件12345678910111213141516171819202122232425262728293031323334353637383...","permalink":"/post/Shell-抽取Jar包中的静态文件","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[{"name":"Shell","slug":"Shell","count":2,"path":"api/categories/Shell.json"}],"tags":[{"name":"Shell","slug":"Shell","count":5,"path":"api/tags/Shell.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%8A%BD%E5%8F%96Jar%E5%8C%85%E4%B8%AD%E7%9A%84%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">抽取Jar包中的静态文件</span></a></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"linux 创建 swap 交换分区","uid":"0506587fbaa1eab77bb8eb284177e762","slug":"linux 创建 swap 交换分区","date":"2019-11-07T05:21:12.000Z","updated":"2025-04-30T08:11:18.900Z","comments":true,"path":"api/articles/linux 创建 swap 交换分区.json","keywords":null,"cover":null,"text":" 大部分云主机都是没有开启 swap 交换分区的, 且内存都在 1-2G 左右, 在编译源码时可能会因为内存不足而编译失败. 1. 创建一个空文件 sudo d...","permalink":"/post/linux 创建 swap 交换分区","photos":[],"count_time":{"symbolsCount":879,"symbolsTime":"1 mins."},"categories":[{"name":"Linux","slug":"Linux","count":7,"path":"api/categories/Linux.json"}],"tags":[{"name":"Linux","slug":"Linux","count":8,"path":"api/tags/Linux.json"},{"name":"Swap","slug":"Swap","count":1,"path":"api/tags/Swap.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Mybatis 自动代码生成","uid":"ce9bd1d7d396ea011c453913a42cce54","slug":"Mybatis 自动代码生成","date":"2019-10-23T04:51:57.000Z","updated":"2025-04-30T08:11:18.862Z","comments":true,"path":"api/articles/Mybatis 自动代码生成.json","keywords":null,"cover":null,"text":"12345678910111213141516171819202122232425262728293031323334353637383940414243444...","permalink":"/post/Mybatis 自动代码生成","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"Mybatis","slug":"Mybatis","count":2,"path":"api/categories/Mybatis.json"}],"tags":[{"name":"Mybatis","slug":"Mybatis","count":2,"path":"api/tags/Mybatis.json"},{"name":"代码生成","slug":"代码生成","count":1,"path":"api/tags/代码生成.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}