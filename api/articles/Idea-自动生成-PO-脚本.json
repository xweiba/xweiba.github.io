{"title":"Idea 自动生成 PO 脚本","uid":"f37e90084f71b064e32056ae6b93b141","slug":"Idea-自动生成-PO-脚本","date":"2020-09-30T05:28:48.000Z","updated":"2025-04-30T08:11:18.846Z","comments":true,"path":"api/articles/Idea-自动生成-PO-脚本.json","keywords":null,"cover":null,"content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>使用 <code>Groovy</code> 脚本生成对应的<code>PO</code>, 非 <code>Mybatis</code>逆向工程生成, </p>\n<p>来自: <a href=\"https://juejin.im/post/6844903846452396039\">IDEA – 自动生成POJO</a></p></blockquote>\n<h2 id=\"Groovy脚本记录\"><a href=\"#Groovy脚本记录\" class=\"headerlink\" title=\"Groovy脚本记录\"></a>Groovy脚本记录</h2><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.intellij.database.model.DasTable</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.intellij.database.model.ObjectKind</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.intellij.database.util.Case</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.intellij.database.util.DasUtil</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.text.DateFormat</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.text.SimpleDateFormat</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * Available context bindings:</span></span><br><span class=\"line\"><span class=\"comment\"> *   SELECTION   Iterable&lt;DasObject&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   PROJECT     project</span></span><br><span class=\"line\"><span class=\"comment\"> *   FILES       files helper</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">packageName = <span class=\"string\">&quot;com.xxx.po;&quot;</span>  <span class=\"comment\">//这里要换成自己项目 实体的包路径</span></span><br><span class=\"line\">typeMapping = [</span><br><span class=\"line\">        (<span class=\"regexp\">~/(?i)int/</span>)                      : <span class=\"string\">&quot;Integer&quot;</span>,  <span class=\"comment\">//数据库类型和Jave类型映射关系</span></span><br><span class=\"line\">        (<span class=\"regexp\">~/(?i)float|double|decimal|real/</span>): <span class=\"string\">&quot;Double&quot;</span>,</span><br><span class=\"line\">        (<span class=\"regexp\">~/(?i)bool|boolean/</span>)             : <span class=\"string\">&quot;Boolean&quot;</span>,</span><br><span class=\"line\">        (<span class=\"regexp\">~/(?i)datetime|timestamp/</span>)       : <span class=\"string\">&quot;java.util.Date&quot;</span>,</span><br><span class=\"line\">        (<span class=\"regexp\">~/(?i)date/</span>)                     : <span class=\"string\">&quot;java.sql.Date&quot;</span>,</span><br><span class=\"line\">        (<span class=\"regexp\">~/(?i)time/</span>)                     : <span class=\"string\">&quot;java.sql.Time&quot;</span>,</span><br><span class=\"line\">        (<span class=\"regexp\">~/(?i)/</span>)                         : <span class=\"string\">&quot;String&quot;</span></span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\">FILES.chooseDirectoryAndSave(<span class=\"string\">&quot;Choose directory&quot;</span>, <span class=\"string\">&quot;Choose where to store generated files&quot;</span>) &#123; dir -&gt;</span><br><span class=\"line\">    SELECTION.filter &#123; it <span class=\"keyword\">instanceof</span> DasTable &amp;&amp; it.getKind() == ObjectKind.TABLE &#125;.each &#123; generate(it, dir) &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> generate(table, dir) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">def</span> className = javaName(table.getName(), <span class=\"literal\">true</span>) + <span class=\"string\">&quot;PO&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> fields = calcFields(table)</span><br><span class=\"line\">    <span class=\"keyword\">new</span> File(dir, className + <span class=\"string\">&quot;.java&quot;</span>).withPrintWriter(<span class=\"string\">&quot;utf-8&quot;</span>) &#123; out -&gt; generate(out, table, className, fields) &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> generate(out, table, className, fields) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">def</span> tableName = table.getName()</span><br><span class=\"line\">    out.println <span class=\"string\">&quot;package $packageName&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;import lombok.*;&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;import javax.persistence.*;&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;/**&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot; * @author xxx&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot; **/&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;@Data&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;@Entity&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;@Table(name = \\&quot;$tableName\\&quot;)&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;public class $className &#123;&quot;</span></span><br><span class=\"line\">    out.println <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">// 这里如果需要生成id字段需要打开</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((tableName + <span class=\"string\">&quot;_id&quot;</span>).equalsIgnoreCase(fields[<span class=\"number\">0</span>].colum) || <span class=\"string\">&quot;id&quot;</span>.equalsIgnoreCase(fields[<span class=\"number\">0</span>].colum)) &#123;</span><br><span class=\"line\">        out.println <span class=\"string\">&quot;    @Id&quot;</span></span><br><span class=\"line\">        out.println <span class=\"string\">&quot;    @GeneratedValue(strategy=GenerationType.IDENTITY)&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fields.each() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (it.comment != <span class=\"string\">&quot;&quot;</span> &amp;&amp; it.comment != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            out.println <span class=\"string\">&quot;    /**&quot;</span></span><br><span class=\"line\">            out.println <span class=\"string\">&quot;      * $&#123;it.comment&#125;&quot;</span></span><br><span class=\"line\">            out.println <span class=\"string\">&quot;      **/&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (it.annos != <span class=\"string\">&quot;&quot;</span>) out.println <span class=\"string\">&quot;  $&#123;it.annos&#125;&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (it.colum != it.name) &#123;</span><br><span class=\"line\">            out.println <span class=\"string\">&quot;    @Column(name = \\&quot;$&#123;it.colum&#125;\\&quot;)&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        out.println <span class=\"string\">&quot;    private $&#123;it.type&#125; $&#123;it.name&#125;;&quot;</span></span><br><span class=\"line\">        out.println <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    out.println <span class=\"string\">&quot;&#125;&quot;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> calcFields(table) &#123;</span><br><span class=\"line\">    DasUtil.getColumns(table).reduce([]) &#123; fields, col -&gt;</span><br><span class=\"line\">        <span class=\"keyword\">def</span> spec = Case.LOWER.apply(col.getDataType().getSpecification())</span><br><span class=\"line\">        <span class=\"keyword\">def</span> typeStr = typeMapping.find &#123; p, t -&gt; p.matcher(spec).find() &#125;.value</span><br><span class=\"line\">        fields += [[</span><br><span class=\"line\">                           <span class=\"attr\">name   :</span> javaName(col.getName(), <span class=\"literal\">false</span>),</span><br><span class=\"line\">                           <span class=\"attr\">colum  :</span> col.getName(),</span><br><span class=\"line\">                           <span class=\"attr\">type   :</span> typeStr,</span><br><span class=\"line\">                           <span class=\"symbol\">comment:</span> col.getComment(),</span><br><span class=\"line\">                           <span class=\"attr\">annos  :</span> <span class=\"string\">&quot;&quot;</span>]]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> javaName(str, capitalize) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">def</span> s = str.split(<span class=\"regexp\">/(?&lt;=[^\\p&#123;IsLetter&#125;])/</span>).collect &#123; Case.LOWER.apply(it).capitalize() &#125;</span><br><span class=\"line\">            .join(<span class=\"string\">&quot;&quot;</span>).replaceAll(<span class=\"regexp\">/[^\\p&#123;javaJavaIdentifierPart&#125;]/</span>, <span class=\"string\">&quot;_&quot;</span>).replaceAll(<span class=\"regexp\">/_/</span>, <span class=\"string\">&quot;&quot;</span>)</span><br><span class=\"line\">    capitalize || s.length() == <span class=\"number\">1</span> ? s : Case.LOWER.apply(s[<span class=\"number\">0</span>]) + s[<span class=\"number\">1.</span>.<span class=\"number\">-1</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","text":" 使用 Groovy 脚本生成对应的PO, 非 Mybatis逆向工程生成, 来自: IDEA – 自动生成POJO Groovy脚本记录12345678910...","permalink":"/post/Idea-自动生成-PO-脚本","photos":[],"count_time":{"symbolsCount":"4.2k","symbolsTime":"4 mins."},"categories":[{"name":"Idea","slug":"Idea","count":4,"path":"api/categories/Idea.json"}],"tags":[{"name":"Idea","slug":"Idea","count":4,"path":"api/tags/Idea.json"},{"name":"Java","slug":"Java","count":11,"path":"api/tags/Java.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Groovy%E8%84%9A%E6%9C%AC%E8%AE%B0%E5%BD%95\"><span class=\"toc-text\">Groovy脚本记录</span></a></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Idea 设置及插件记录","uid":"f5cbc0301f4d116b2f3249f5495844f0","slug":"Idea-设置及插件记录","date":"2020-10-14T01:30:19.000Z","updated":"2025-04-30T08:11:18.846Z","comments":true,"path":"api/articles/Idea-设置及插件记录.json","keywords":null,"cover":[],"text":" 记录下新环境的配置 生成类/接口注释设置位置: Setting-Editor-File and Code Templates-Class|Interface ...","permalink":"/post/Idea-设置及插件记录","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"Idea","slug":"Idea","count":4,"path":"api/categories/Idea.json"}],"tags":[{"name":"Idea","slug":"Idea","count":4,"path":"api/tags/Idea.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Linux 安装配置 Elasticsearch-2.4.6","uid":"3bdfbcd280906945c52159d485008d9b","slug":"Linux-安装配置-ElasticSearch-2-4-6","date":"2020-09-29T08:01:01.000Z","updated":"2025-04-30T08:11:18.861Z","comments":true,"path":"api/articles/Linux-安装配置-ElasticSearch-2-4-6.json","keywords":null,"cover":null,"text":" ES最新版已经到 7.x 了, 想用最新版啊, 多了很多特性.但是这个环境是做业务测试的, 原来用的就是 2.4.6 , 防止出问题, 延续了. 下载安装进入...","permalink":"/post/Linux-安装配置-ElasticSearch-2-4-6","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"ElasticSearch","slug":"ElasticSearch","count":1,"path":"api/categories/ElasticSearch.json"}],"tags":[{"name":"Linux","slug":"Linux","count":8,"path":"api/tags/Linux.json"},{"name":"Elasticsearch","slug":"Elasticsearch","count":1,"path":"api/tags/Elasticsearch.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}