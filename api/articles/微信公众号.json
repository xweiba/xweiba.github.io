{"title":"微信公众号","uid":"752ca52abe96279b156b2c1db908bcf9","slug":"微信公众号","date":"2018-07-15T05:01:28.000Z","updated":"2025-04-30T08:11:18.901Z","comments":true,"path":"api/articles/微信公众号.json","keywords":null,"cover":null,"content":"<h1 id=\"今天完成的事情：\"><a href=\"#今天完成的事情：\" class=\"headerlink\" title=\"今天完成的事情：\"></a>今天完成的事情：</h1><p>完成微信登陆认证流程, 通过opeonId 和 access_token 获取用户信息</p>\n<h1 id=\"微信公众号获取用户信息\"><a href=\"#微信公众号获取用户信息\" class=\"headerlink\" title=\"微信公众号获取用户信息\"></a>微信公众号获取用户信息</h1><h2 id=\"1-获取code-必须在微信开发工具或者微信中打开才会跳转\"><a href=\"#1-获取code-必须在微信开发工具或者微信中打开才会跳转\" class=\"headerlink\" title=\"1. 获取code, 必须在微信开发工具或者微信中打开才会跳转\"></a>1. 获取code, 必须在微信开发工具或者微信中打开才会跳转</h2><ul>\n<li>redirect_uri必须填写网页授权域名, 公众号设置&gt;功能设置&gt;网页授权域名<br><code>https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2750055a558bbe86&amp;redirect_uri=http://academy.home.canary.dounixue.net/&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=STATE#wechat_redirect</code></li>\n<li>跳转后url<br><code>http://academy.home.canary.dounixue.net/?code=001oDwYl1bI7al0xsVXl1AqTYl1oDwYD&amp;state=STATE</code></li>\n</ul>\n<h2 id=\"2-通过code以及appid-secret-获取-access-token\"><a href=\"#2-通过code以及appid-secret-获取-access-token\" class=\"headerlink\" title=\"2. 通过code以及appid&#x2F;secret 获取 access_token\"></a>2. 通过code以及appid&#x2F;secret 获取 access_token</h2><ul>\n<li>通过code获取access_token, wx2750055a558bbe86&#x2F;fe33aae20890da44fc14c709468b7a91<br><code>https://api.weixin.qq.com/sns/oauth2/access_token?appid=wx2750055a558bbe86&amp;secret=fe33aae20890da44fc14c709468b7a91&amp;code=0815xeel0JaaOl1HRxfl06bcel05xee7&amp;grant_type=authorization_code</code></li>\n<li>返回结果:<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;access_token&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;12_Y7wwnaQ8VA5joJfIEcZSKtO8h5Omrvn80be6nb18jG_9Ad1YetJDEEwCLpnQqaNcq1JlUVuZoXvPsu0QPJ73TA&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;expires_in&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">7200</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;refresh_token&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;12_4jUAxLbsJ-H_Tcu9A4EJr7CxNcvQZrMwbtokLVdfXUnionm9aRXdDY3fEX-ZkhfeTzQfl9rgt2kz3FbTefWV7g&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;openid&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;oSV35t_fiRPKozt9JV4kQD-O5XMg&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;scope&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;snsapi_userinfo&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"3-刷新access-token（如果需要）\"><a href=\"#3-刷新access-token（如果需要）\" class=\"headerlink\" title=\"3. 刷新access_token（如果需要）\"></a>3. 刷新access_token（如果需要）</h2><p>由于access_token拥有较短的有效期，当access_token超时后，可以使用refresh_token进行刷新，refresh_token有效期为30天，当refresh_token失效之后，需要用户重新授权。<br><code>https://api.weixin.qq.com/sns/oauth2/refresh_token?appid=wx2750055a558bbe86&amp;grant_type=refresh_token&amp;refresh_token=12_4jUAxLbsJ-H_Tcu9A4EJr7CxNcvQZrMwbtokLVdfXUnionm9aRXdDY3fEX-ZkhfeTzQfl9rgt2kz3FbTefWV7g</code></p>\n<ul>\n<li>返回结果:<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;openid&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;oSV35t_fiRPKozt9JV4kQD-O5XMg&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;access_token&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;12_Y7wwnaQ8VA5joJfIEcZSKtO8h5Omrvn80be6nb18jG_9Ad1YetJDEEwCLpnQqaNcq1JlUVuZoXvPsu0QPJ73TA&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;expires_in&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">7200</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;refresh_token&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;12_4jUAxLbsJ-H_Tcu9A4EJr7CxNcvQZrMwbtokLVdfXUnionm9aRXdDY3fEX-ZkhfeTzQfl9rgt2kz3FbTefWV7g&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;scope&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;snsapi_base,snsapi_userinfo,&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"通过openid-和-access-token-获取用户基本信息\"><a href=\"#通过openid-和-access-token-获取用户基本信息\" class=\"headerlink\" title=\"通过openid 和 access_token 获取用户基本信息\"></a>通过openid 和 access_token 获取用户基本信息</h2><p><a href=\"https://api.weixin.qq.com/sns/userinfo?access_token=12_iMk8sNzOKW_jN6qpZrw8PwP4NKApKVaf40PojX_w7I49kqod3Eorwk0OhG-BDcow4d2a4wgtQAbcK5GDzhWd8Q&lang=zh_CN\">https://api.weixin.qq.com/sns/userinfo?access_token=12_iMk8sNzOKW_jN6qpZrw8PwP4NKApKVaf40PojX_w7I49kqod3Eorwk0OhG-BDcow4d2a4wgtQAbcK5GDzhWd8Q&amp;lang=zh_CN</a></p>\n<ul>\n<li>返回结果:<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\"><span class=\"attr\">&quot;openid&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;oSV35t_fiRPKozt9JV4kQD-O5XMg&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;nickname&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;.&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;sex&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;language&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;zh_CN&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;city&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;province&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;上海&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;country&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;中国&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;headimgurl&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJibfyYTuSD3nIVDfhkyKHy4NdfrF5ibQDSicW4ocn3Jw8W8NkwLpcjpQWKZuV7YSMHtQGCCBOAeGXXg/132&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\"><span class=\"attr\">&quot;privilege&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h1 id=\"明天计划的事\"><a href=\"#明天计划的事\" class=\"headerlink\" title=\"明天计划的事:\"></a>明天计划的事:</h1><p>完成微信demo, 完善方案设计<br><a href=\"https://api.weixin.qq.com/sns/userinfo?access_token=ACCESS_TOKEN&openid=OPENID&lang=zh_CN\">https://api.weixin.qq.com/sns/userinfo?access_token=ACCESS_TOKEN&amp;openid=OPENID&amp;lang=zh_CN</a><br><a href=\"https://api.weixin.qq.com/sns/userinfo?access_token=12_BKHVHYjgA18AawXYiPOzKwOR3ZGUBnsLmiUrPLbI9MePuPNw1b4NXSpt8qwIUTBxIiudSOjOme81qxABhXhUew&openid=oSV35t_fiRPKozt9JV4kQD-O5XMg\">https://api.weixin.qq.com/sns/userinfo?access_token=12_BKHVHYjgA18AawXYiPOzKwOR3ZGUBnsLmiUrPLbI9MePuPNw1b4NXSpt8qwIUTBxIiudSOjOme81qxABhXhUew&amp;openid=oSV35t_fiRPKozt9JV4kQD-O5XMg</a></p>\n","text":"今天完成的事情：完成微信登陆认证流程, 通过opeonId 和 access_token 获取用户信息 微信公众号获取用户信息1. 获取code, 必须在微信开...","permalink":"/post/微信公众号","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"微信公众号","slug":"微信公众号","count":1,"path":"api/categories/微信公众号.json"}],"tags":[{"name":"微信公众号","slug":"微信公众号","count":1,"path":"api/tags/微信公众号.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BB%8A%E5%A4%A9%E5%AE%8C%E6%88%90%E7%9A%84%E4%BA%8B%E6%83%85%EF%BC%9A\"><span class=\"toc-text\">今天完成的事情：</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">微信公众号获取用户信息</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E8%8E%B7%E5%8F%96code-%E5%BF%85%E9%A1%BB%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E6%88%96%E8%80%85%E5%BE%AE%E4%BF%A1%E4%B8%AD%E6%89%93%E5%BC%80%E6%89%8D%E4%BC%9A%E8%B7%B3%E8%BD%AC\"><span class=\"toc-text\">1. 获取code, 必须在微信开发工具或者微信中打开才会跳转</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E9%80%9A%E8%BF%87code%E4%BB%A5%E5%8F%8Aappid-secret-%E8%8E%B7%E5%8F%96-access-token\"><span class=\"toc-text\">2. 通过code以及appid&#x2F;secret 获取 access_token</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E5%88%B7%E6%96%B0access-token%EF%BC%88%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%EF%BC%89\"><span class=\"toc-text\">3. 刷新access_token（如果需要）</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%80%9A%E8%BF%87openid-%E5%92%8C-access-token-%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">通过openid 和 access_token 获取用户基本信息</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%98%8E%E5%A4%A9%E8%AE%A1%E5%88%92%E7%9A%84%E4%BA%8B\"><span class=\"toc-text\">明天计划的事:</span></a></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Java 服务中文乱码","uid":"6aa8ceb80f4b9b7def699e1275eccff9","slug":"Java 服务中文乱码","date":"2018-07-26T04:58:33.000Z","updated":"2025-04-30T08:11:18.851Z","comments":true,"path":"api/articles/Java 服务中文乱码.json","keywords":null,"cover":null,"text":" 最近发现运维大哥在新环境部署相关服务后生成的数据出现中文乱码的问题, 记录一下 修改系统编码环境变量locale 查看当前系统编码: 这是修改后正常状态, 如...","permalink":"/post/Java 服务中文乱码","photos":[],"count_time":{"symbolsCount":563,"symbolsTime":"1 mins."},"categories":[{"name":"Java","slug":"Java","count":5,"path":"api/categories/Java.json"}],"tags":[{"name":"Java","slug":"Java","count":11,"path":"api/tags/Java.json"},{"name":"乱码","slug":"乱码","count":1,"path":"api/tags/乱码.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"XML 转义字符","uid":"1cb851a3d1c3d38a1164a75bed172ba4","slug":"XML 转义字符","date":"2018-07-13T05:03:35.000Z","updated":"2025-04-30T08:11:18.866Z","comments":true,"path":"api/articles/XML 转义字符.json","keywords":null,"cover":null,"text":"xml 处理类 在xml对象属性上添加注解: @XmlJavaTypeAdapter(CollapsedStringAdapter.class) 即可 1234...","permalink":"/post/XML 转义字符","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"XML","slug":"XML","count":1,"path":"api/categories/XML.json"}],"tags":[{"name":"XML","slug":"XML","count":1,"path":"api/tags/XML.json"},{"name":"转义","slug":"转义","count":1,"path":"api/tags/转义.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}