{"title":"Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题(添加版本号)","uid":"473446b30e00b79edab02d113b4cd921","slug":"Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题","date":"2019-08-08T04:55:49.000Z","updated":"2025-04-30T08:11:18.865Z","comments":true,"path":"api/articles/Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题.json","keywords":null,"cover":null,"content":"<h1 id=\"后端\"><a href=\"#后端\" class=\"headerlink\" title=\"后端\"></a>后端</h1><p>spring boot 添加配置: </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 国际化</span><br><span class=\"line\">i18n:</span><br><span class=\"line\">  locale: zh_TW</span><br><span class=\"line\"># 静态资源版本</span><br><span class=\"line\">build:</span><br><span class=\"line\">  version: 010-0.0.2 #项目版本-静态资源版本</span><br></pre></td></tr></table></figure>\n<p>启动类中使用增强器为每个<code>Controller</code>注入变量</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Value(&quot;$&#123;i18n.locale&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> String locale;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ControllerAdvice</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GlobalVariableController</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;build.version:0.0.1&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String buildVersion;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">GlobalVariableController</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ModelAttribute</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">getLocale</span><span class=\"params\">(Model model)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Locale</span> <span class=\"variable\">_locale</span> <span class=\"operator\">=</span> ((LocaleResolver)SpringBeanUtils.getBean(LocaleResolver.class)).resolveLocale((HttpServletRequest)<span class=\"literal\">null</span>);</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;_locale&quot;</span>, _locale.toString());</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;_v&quot;</span>, <span class=\"built_in\">this</span>.buildVersion);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"前端\"><a href=\"#前端\" class=\"headerlink\" title=\"前端\"></a>前端</h1><p>thymeleaf: </p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">th:src</span>=<span class=\"string\">&quot;@&#123;/js/jQuery/jquery-3.0.0.min.js(v=$&#123;_v&#125;)&#125;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 加载国际化js静态文件 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span> <span class=\"attr\">th:src</span>=<span class=\"string\">&quot;@&#123;|/js/publicFile_$&#123;_locale&#125;.js|(v=$&#123;_v&#125;)&#125;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>","text":"后端spring boot 添加配置: 123456# 国际化i18n: locale: zh_TW# 静态资源版本build: version: 010-0....","permalink":"/post/Thymeleaf - 注入自定义变量解决国际化及静态文件缓存问题","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"Thymeleaf","slug":"Thymeleaf","count":4,"path":"api/categories/Thymeleaf.json"}],"tags":[{"name":"Thymeleaf","slug":"Thymeleaf","count":5,"path":"api/tags/Thymeleaf.json"},{"name":"国际化","slug":"国际化","count":3,"path":"api/tags/国际化.json"},{"name":"web缓存","slug":"web缓存","count":1,"path":"api/tags/web缓存.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%90%8E%E7%AB%AF\"><span class=\"toc-text\">后端</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E7%AB%AF\"><span class=\"toc-text\">前端</span></a></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"JS工具集","uid":"70f3dc3b65ff84d1ff3522c18e25ad00","slug":"JS 工具集","date":"2019-08-08T05:47:41.000Z","updated":"2025-04-30T08:11:18.848Z","comments":true,"path":"api/articles/JS 工具集.json","keywords":null,"cover":null,"text":"CommUtils.jsjs 工具集合: 12345678910111213141516171819202122232425262728293031323334...","permalink":"/post/JS 工具集","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"JS","slug":"JS","count":1,"path":"api/categories/JS.json"}],"tags":[{"name":"JS","slug":"JS","count":1,"path":"api/tags/JS.json"},{"name":"工具","slug":"工具","count":1,"path":"api/tags/工具.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Thymeleaf VUE 混用奇葩语法","uid":"84714c780858e0d1bf03e058f223b43c","slug":"Thymeleaf VUE 混用奇葩语法","date":"2019-08-08T04:54:19.000Z","updated":"2025-04-30T08:11:18.865Z","comments":true,"path":"api/articles/Thymeleaf VUE 混用奇葩语法.json","keywords":null,"cover":null,"text":"th中使用vue变量 123456<span th:text=\"'{{questionResourceType.count}}' + #{UI_38_02_01...","permalink":"/post/Thymeleaf VUE 混用奇葩语法","photos":[],"count_time":{"symbolsCount":779,"symbolsTime":"1 mins."},"categories":[{"name":"Thymeleaf","slug":"Thymeleaf","count":4,"path":"api/categories/Thymeleaf.json"}],"tags":[{"name":"Thymeleaf","slug":"Thymeleaf","count":5,"path":"api/tags/Thymeleaf.json"},{"name":"VUE","slug":"VUE","count":1,"path":"api/tags/VUE.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}