{"title":"PVE LXC 常用配置","uid":"a06638b83fc487413a350d2959840084","slug":"PVE LXC 常用配置","date":"2022-12-23T06:39:40.000Z","updated":"2025-04-30T08:11:18.862Z","comments":true,"path":"api/articles/PVE LXC 常用配置.json","keywords":null,"cover":null,"content":"<h1 id=\"LXC配置\"><a href=\"#LXC配置\" class=\"headerlink\" title=\"LXC配置\"></a>LXC配置</h1><p>1.Ubuntu开启硬件直通</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arch: amd64</span><br><span class=\"line\">cores: 4</span><br><span class=\"line\">features: nesting=1</span><br><span class=\"line\">hostname: Ububtu-20.04</span><br><span class=\"line\">memory: 7680</span><br><span class=\"line\">mp1: /mnt/nas,mp=/mnt/nas</span><br><span class=\"line\">mp2: /mnt/aliyun,mp=/mnt/aliyun</span><br><span class=\"line\">onboot: 0</span><br><span class=\"line\">ostype: ubuntu</span><br><span class=\"line\">rootfs: local:101/vm-101-disk-0.raw,size=10G</span><br><span class=\"line\">swap: 0</span><br><span class=\"line\">lxc.net.0.type: phys</span><br><span class=\"line\">lxc.net.0.link: enp3s0</span><br><span class=\"line\">lxc.net.0.ipv4.address: 192.168.186.230/24</span><br><span class=\"line\">lxc.net.0.ipv4.gateway: 192.168.186.1</span><br><span class=\"line\">lxc.net.0.flags: up</span><br><span class=\"line\">lxc.apparmor.profile: unconfined</span><br><span class=\"line\">lxc.cgroup.devices.allow: a</span><br><span class=\"line\">lxc.cap.drop: </span><br><span class=\"line\">lxc.cgroup2.devices.allow: c 226:0 rwm</span><br><span class=\"line\">lxc.cgroup2.devices.allow: c 226:128 rwm</span><br><span class=\"line\">lxc.mount.entry: /dev/dri/card0 dev/dri/card0 none bind,optional,create=file</span><br><span class=\"line\">lxc.mount.entry: /dev/dri/renderD128 dev/dri/renderD128 none bind,optional,create=file</span><br><span class=\"line\">lxc.mount.entry: /dev/fuse dev/fuse none bind,create=file</span><br></pre></td></tr></table></figure>\n\n<p>2.OpenWrt Clash</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arch: amd64</span><br><span class=\"line\">cores: 2</span><br><span class=\"line\">hookscript: local:snippets/hookscript.pl</span><br><span class=\"line\">hostname: Lede-OpenWRT</span><br><span class=\"line\">memory: 512</span><br><span class=\"line\">net0: name=eth0,bridge=vmbr0,hwaddr=D6:DC:B4:4F:77:EF,type=veth</span><br><span class=\"line\">onboot: 1</span><br><span class=\"line\">ostype: unmanaged</span><br><span class=\"line\">rootfs: local:100/vm-100-disk-0.raw,size=204M</span><br><span class=\"line\">swap: 0</span><br></pre></td></tr></table></figure>\n\n<p>3.openwrt.common.conf</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Default console settings</span><br><span class=\"line\">lxc.tty.dir = lxc</span><br><span class=\"line\">lxc.tty.max = 4</span><br><span class=\"line\">lxc.pty.max = 1024</span><br><span class=\"line\"></span><br><span class=\"line\"># Default capabilities</span><br><span class=\"line\">lxc.cap.drop = mac_admin</span><br><span class=\"line\">lxc.cap.drop = mac_override</span><br><span class=\"line\">lxc.cap.drop = sys_admin</span><br><span class=\"line\">lxc.cap.drop = sys_module</span><br><span class=\"line\">lxc.cap.drop = sys_nice</span><br><span class=\"line\">lxc.cap.drop = sys_pacct</span><br><span class=\"line\">#lxc.cap.drop = sys_ptrace</span><br><span class=\"line\">lxc.cap.drop = sys_rawio</span><br><span class=\"line\">#lxc.cap.drop = sys_resource</span><br><span class=\"line\">lxc.cap.drop = sys_time</span><br><span class=\"line\">lxc.cap.drop = sys_tty_config</span><br><span class=\"line\">lxc.cap.drop = syslog</span><br><span class=\"line\">lxc.cap.drop = wake_alarm</span><br><span class=\"line\"></span><br><span class=\"line\"># Default cgroups - all denied except those whitelisted</span><br><span class=\"line\">lxc.cgroup.devices.deny = a</span><br><span class=\"line\">## /dev/null and zero</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 1:3 rwm</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 1:5 rwm</span><br><span class=\"line\">## consoles</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 5:0 rwm</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 5:1 rwm</span><br><span class=\"line\">## /dev/&#123;,u&#125;random</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 1:8 rwm</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 1:9 rwm</span><br><span class=\"line\">## /dev/pts/*</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 5:2 rwm</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 136:* rwm</span><br><span class=\"line\">## rtc</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 254:0 rm</span><br><span class=\"line\">## tun</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 10:200 rwm</span><br><span class=\"line\">## dev/tty0</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 4:0 rwm</span><br><span class=\"line\">## dev/tty1</span><br><span class=\"line\">lxc.cgroup.devices.allow = c 4:1 rwm</span><br><span class=\"line\"></span><br><span class=\"line\">## To use loop devices, copy the following line to the container&#x27;s</span><br><span class=\"line\">## configuration file (uncommented).</span><br><span class=\"line\">#lxc.cgroup.devices.allow = b 7:* rwm</span><br><span class=\"line\"></span><br><span class=\"line\"># Blacklist some syscalls which are not safe in privileged</span><br><span class=\"line\"># containers</span><br><span class=\"line\">lxc.seccomp.profile = /usr/share/lxc/config/common.seccomp</span><br></pre></td></tr></table></figure>\n\n","text":"LXC配置1.Ubuntu开启硬件直通 123456789101112131415161718192021222324arch: amd64cores: 4fe...","permalink":"/post/PVE LXC 常用配置","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"PVE","slug":"PVE","count":1,"path":"api/categories/PVE.json"}],"tags":[{"name":"PVE","slug":"PVE","count":1,"path":"api/tags/PVE.json"},{"name":"LXC","slug":"LXC","count":1,"path":"api/tags/LXC.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#LXC%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">LXC配置</span></a></li></ol>","author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"DDNS和证书配置","uid":"cbe323e32f8b37c93337862c65bef9d6","slug":"DDNS和证书配置","date":"2022-12-23T06:42:26.000Z","updated":"2025-04-30T08:11:18.832Z","comments":true,"path":"api/articles/DDNS和证书配置.json","keywords":null,"cover":null,"text":"DDNS 项目地址：https://github.com/rehiy/dnspod-shell 一、编辑配置文件vim ddnspod.sh 123456789...","permalink":"/post/DDNS和证书配置","photos":[],"count_time":{"symbolsCount":859,"symbolsTime":"1 mins."},"categories":[{"name":"DDNS","slug":"DDNS","count":1,"path":"api/categories/DDNS.json"}],"tags":[{"name":"DDNS","slug":"DDNS","count":1,"path":"api/tags/DDNS.json"},{"name":"HTTPS","slug":"HTTPS","count":1,"path":"api/tags/HTTPS.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"常用正则表达式","uid":"85b8693a512d03bf427ab4982831b7cd","slug":"常用正则表达式","date":"2022-12-23T06:37:54.000Z","updated":"2025-04-30T08:11:18.901Z","comments":true,"path":"api/articles/常用正则表达式.json","keywords":null,"cover":null,"text":"提取字符串中的图片地址 123456789101112String url = \"<div><img width=\\\"864px\\\" height=\\\"148p...","permalink":"/post/常用正则表达式","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"正则表达式","slug":"正则表达式","count":1,"path":"api/categories/正则表达式.json"}],"tags":[{"name":"常用命令","slug":"常用命令","count":10,"path":"api/tags/常用命令.json"},{"name":"正则表达式","slug":"正则表达式","count":1,"path":"api/tags/正则表达式.json"}],"author":{"name":"Weiba","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/24520686?v=4","link":"/","description":"啊 又忘了更新了！","socials":{"github":"https://github.com/xweiba","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}